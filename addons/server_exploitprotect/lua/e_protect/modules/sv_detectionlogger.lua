eProtect = eProtect or {}
eProtect.data = eProtect.data or {}
eProtect.data.punishmentLogging = eProtect.data.punishmentLogging or {}
local punished = {}

eProtect.logDetection = function(ply, reason, info, type)
    if eProtect.data.general["bypassgroup"][ply:GetUserGroup()] then return end
    local sid = ply:SteamID()
    if punished[sid] and CurTime() < punished[sid] then return end
    punished[sid] = CurTime() + eProtect.data.general.timeout + 1

    eProtect.data.punishmentLogging[#eProtect.data.punishmentLogging + 1] = {ply = ply:Nick(), reason = reason, info = info, type = type}
    eProtect.queueNetworking(nil, "punishmentLogging")

    eProtect.saveData()
end

if eProtect.queueNetworking then
    eProtect.queueNetworking(nil, "punishmentLogging")
end